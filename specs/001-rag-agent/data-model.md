# Data Model: RAG Agent

## User Query Entity
**Description**: Represents the question or request submitted by the user

**Fields**:
- `query_text` (string): The text of the user's question or request
- `context` (string, optional): Additional context provided by the user
- `metadata` (dict, optional): Additional metadata for the query (e.g., user ID, session info)

**Validation**:
- query_text must not be empty
- query_text length must be within API limits
- metadata keys must be valid strings

## Retrieved Context Entity
**Description**: Represents the relevant text chunks retrieved from Qdrant based on similarity search

**Fields**:
- `id` (string): Unique identifier for the context chunk
- `content` (string): The text content of the retrieved chunk
- `source_url` (string): URL or identifier of the original source
- `similarity_score` (float): Score indicating how similar this chunk is to the query
- `metadata` (dict): Additional metadata from Qdrant (e.g., document title, section)

**Validation**:
- content must not be empty
- similarity_score must be between 0 and 1
- source_url must be a valid URL or identifier

## Generated Answer Entity
**Description**: Represents the response generated by the OpenAI Agent based on the user query and retrieved context

**Fields**:
- `id` (string): Unique identifier for the answer
- `answer_text` (string): The text of the generated answer
- `confidence_score` (float): Confidence level in the answer's accuracy
- `sources` (list[string]): List of source URLs that contributed to the answer
- `timestamp` (datetime): When the answer was generated
- `query_id` (string): Reference to the original query

**Validation**:
- answer_text must not be empty
- confidence_score must be between 0 and 1
- sources must be valid URLs or identifiers

## API Response Entity
**Description**: Represents the structured response returned to the user containing the answer and metadata

**Fields**:
- `query_id` (string): Unique identifier for the query
- `answer` (Generated Answer): The generated answer object
- `retrieved_contexts` (list[Retrieved Context]): List of contexts used to generate the answer
- `processing_time` (float): Time taken to process the query in seconds
- `status` (string): Status of the request (success, partial, error)
- `error_message` (string, optional): Error message if the request failed

**Validation**:
- query_id must be unique
- processing_time must be positive
- status must be one of the defined values
- If status is 'error', error_message must be provided

## Agent Configuration Entity
**Description**: Represents the configuration for the OpenAI Agent

**Fields**:
- `agent_id` (string): Unique identifier for the agent
- `model_name` (string): Name of the OpenAI model to use
- `temperature` (float): Temperature setting for response creativity
- `max_tokens` (integer): Maximum tokens for the response
- `system_prompt` (string): System prompt to guide the agent's behavior

**Validation**:
- model_name must be a valid OpenAI model
- temperature must be between 0 and 1
- max_tokens must be positive
- system_prompt must not be empty